<?php

    if ($_SERVER["REQUEST_METHOD"] == "POST") {
        
        if(isset($_POST['payload'])){
            $payload = json_decode($_POST['payload']);
            if(!isset($_SERVER['HTTP_REFERER'])){
                if(isset($payload->_token)){
                    if($payload->_token == "ThlsC5RFi5Sup3REzy"){
                       echo 'flag is Q_token{ThlsC5RFi5Sup3REzy}'; 
                    }else{
                       echo 'Failed Comparison ( incoming CSRF token != Session CSRF token ), behind is weak comparison >.<';
                    }
                    
                }else{
                    echo 'Now the origin in request are not the same, Failed Comparison ( incoming CSRF token != Session CSRF token )';
                }
            }
            else if(isset($payload->_token)){
                $_token = $payload->_token;
                // echo gettype($_token);
                if($_token == 'ilovephp'){
                    echo 'try to send post request by another host, this is concept behind CSRF';
                }else{
                    echo 'wrong token, not token that site issue';
                }
            }
        }else{
            echo 'need {payload : JSON.Stringify}';
        }
    }
?>