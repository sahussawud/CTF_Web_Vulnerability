<?php

    if ($_SERVER["REQUEST_METHOD"] == "POST") {
        // collect value of input field
        // $_token = $_POST['_token'];
        // if (empty($_token)) {
        //   echo "_token is empty";
        // } else {
        //   echo $_token;
        // }
        // header("Access-Control-Allow-Origin: ");
        if(!isset($_SERVER['HTTP_REFERER'])){ 
            if(isset($_POST['_token']) && $_POST['_token'] == "ThlsC5RFi5Sup3REzy"){
                echo 'Q_token{ThlsC5RFi5Sup3REzy}';
            }else{
                echo 'Failed Comparison ( incoming CSRF token != Session CSRF token )';
            }
        }
        else if(isset($_POST['_token'])){
            $_token = $_POST['_token'];
            if($_token == 'ilovephp'){
                echo 'try to send post request by another host, this is concept behind CSRF';
            }else{
                echo 'wrong token';
            }
        }
    }
