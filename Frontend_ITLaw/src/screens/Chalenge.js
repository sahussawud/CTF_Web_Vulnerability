import React, { useState, useEffect } from 'react'
import '../App.css';
import FacebookLogin from 'react-facebook-login';
import axios from 'axios';
import { Link } from "react-router-dom";
import {
    Navbar,
    Nav,
    NavDropdown,
    Button,
    Form,
    FormControl,
  } from "react-bootstrap";





const Chalenge = () =>{

    const [datauser1, setDatauser1] = useState(null)
    const [answer1, setAnswer1] = useState('')
    
    const [datauser2, setDatauser2] = useState(null)
    const [answer2, setAnswer2] = useState('')

    const [datauser3, setDatauser3] = useState(null)
    const [answer3, setAnswer3] = useState('')

    const [datauser4, setDatauser4] = useState(null)
    const [answer4, setAnswer4] = useState('')

    const [datauser5, setDatauser5] = useState(null)
    const [answer5, setAnswer5] = useState('')

    const [datauser6, setDatauser6] = useState(null)
    const [answer6, setAnswer6] = useState('')


    
    const [checkanswer1, setCheckanswer1] = useState('')
    const [checkanswer2, setCheckanswer2] = useState('')
    const [checkanswer3, setCheckanswer3] = useState('')
    const [checkanswer4, setCheckanswer4] = useState('')
    const [checkanswer5, setCheckanswer5] = useState('')
    const [checkanswer6, setCheckanswer6] = useState('')




    const getDatauser = async () =>{
        var token = localStorage.getItem('token')
        console.log('token', token)
        await axios.get('https://serveritlaw.herokuapp.com/users/')
        .then((res)=>{
            res.data.map((data) => {
                if(data.iduser == token){
                    setDatauser1(data.question1)
                    setDatauser2(data.question2)
                    setDatauser3(data.question3)
                    setDatauser4(data.question4)
                    setDatauser5(data.question5)
                    setDatauser6(data.question6)

                }
            })
        })

    }
    useEffect(()=>{
        getDatauser()
    },[])

    const sendAnswer1 = (event) =>{
        event.preventDefault();
        if (answer1 == "") {

        }else{
            const checkanswer = {
                "answer" : answer1,
                "idanswer" : 1
            }
            axios.post('https://serveritlaw.herokuapp.com/question/answer', checkanswer)
                .then(async (res) => {
                    if(res.status == 200) {
                        setCheckanswer1('Correct')
                        setDatauser1(true)
                        var token = localStorage.getItem('token')
                        await axios.get('https://serveritlaw.herokuapp.com/users/')
                        .then((res)=>{
                            res.data.map(async (data) => {
                                if(data.iduser == token){
                                    const infomation = {
                                        name : data.name,
                                        imageuser : data.imageuser,
                                        iduser : data.iduser,
                                        email : data.email,
                                        score: 20,
                                        datauser1 : true 
                                    }
                                await axios.post('https://serveritlaw.herokuapp.com/renderboard/add', infomation)
                                    .then( async () => {
                                    })
                                    .catch((er) => console.log(er.message))
                                }else{
                                    console.log('check data1', token)
                                    console.log('check data2', data.iduser)

                                }
                            })
                        })
                    }else{
                        console.log('not pass')
                        setCheckanswer1(' is not Correct')
                    }
                })
                .catch(() => {
                    setCheckanswer1(' is not Correct')
                    console.log('not pass')
                })
        }
    }

    const sendAnswer2 = (event) =>{
        event.preventDefault();
        if (answer2 == "") {

        }else{
            const checkanswer = {
                "answer" : answer2,
                "idanswer" : 2
            }
            axios.post('https://serveritlaw.herokuapp.com/question/answer', checkanswer)
                .then((res) => {
                    if(res.status == 200) {
                        setCheckanswer2('Correct')
                        setDatauser2(true)
<<<<<<< Updated upstream

=======
>>>>>>> Stashed changes
                        var token = localStorage.getItem('token')
                        axios.get('https://serveritlaw.herokuapp.com/users/')
                        .then((res)=>{
                            res.data.map((data) => {
                                if(data.iduser == token){
                                    const infomation = {
                                        name : data.name,
                                        imageuser : data.imageuser,
                                        iduser : data.iduser,
                                        email : data.email,
                                        score: 20,
                                        datauser2 : true
                                    }
                                    axios.post('https://serveritlaw.herokuapp.com/renderboard/add', infomation)
                                    .then(() => window.location.reload())
                                    .catch((er) => console.log(er.message))
                                }else{
                                    console.log('check data1', token)
                                    console.log('check data2', data.iduser)

                                }
                            })
                        })
                        
                    }else{
                        console.log('not pass')
                        setCheckanswer2(' is not Correct')
                    }
                })
                .catch(() => {
                    setCheckanswer2(' is not Correct')
                    console.log('not pass')
                })
            }
       
    }
    const sendAnswer3 = (event) =>{
        event.preventDefault();
        if (answer3 == "") {
            console.log('null data')
        }else{
            const checkanswer = {
                "answer" : answer3,
                "idanswer" : 3
            }
            axios.post('https://serveritlaw.herokuapp.com/question/answer', checkanswer)
                .then((res) => {
                    if(res.status == 200) {
                        setCheckanswer3('Correct')
                        setDatauser3(true)
<<<<<<< Updated upstream

=======
>>>>>>> Stashed changes
                        var token = localStorage.getItem('token')
                        axios.get('https://serveritlaw.herokuapp.com/users/')
                        .then((res)=>{
                            res.data.map((data) => {
                                if(data.iduser == token){
                                    const infomation = {
                                        name : data.name,
                                        imageuser : data.imageuser,
                                        iduser : data.iduser,
                                        email : data.email,
                                        score: 20,
                                        datauser3 : true
                                    }
                                    axios.post('https://serveritlaw.herokuapp.com/renderboard/add', infomation)
                                    .then(() => console.log('pass'))
                                    .catch((er) => console.log(er.message))
                                }else{
                                    console.log('check data1', token)
                                    console.log('check data2', data.iduser)

                                }
                            })
                        })
                    }else{
                        console.log('not pass')
                        setCheckanswer3(' is not Correct')
                    }
                })
                .catch(() => {
                    setCheckanswer3(' is not Correct')
                    console.log('not pass')
                })
        }
    }
    const sendAnswer4 = (event) =>{
        event.preventDefault();
        if (answer4 == "") {
            console.log('nuul data');
        }else{
        const checkanswer = {
            "answer" : answer4,
            "idanswer" : 4
        }
        axios.post('https://serveritlaw.herokuapp.com/question/answer', checkanswer)
            .then((res) => {
                if(res.status == 200) {
                    setCheckanswer4('Correct')
                    setDatauser4(true)
<<<<<<< Updated upstream

=======
>>>>>>> Stashed changes
                    var token = localStorage.getItem('token')
                    axios.get('https://serveritlaw.herokuapp.com/users/')
                    .then((res)=>{
                        res.data.map((data) => {
                            if(data.iduser == token){
                                const infomation = {
                                    name : data.name,
                                    imageuser : data.imageuser,
                                    iduser : data.iduser,
                                    email : data.email,
                                    score: 20,
                                    datauser4 : true
                                }
                                axios.post('https://serveritlaw.herokuapp.com/renderboard/add', infomation)
                                .then(() => console.log('pass'))
                                .catch((er) => console.log(er.message))
                            }else{
                                console.log('check data1', token)
                                console.log('check data2', data.iduser)

                            }
                        })
                    })
                }else{
                    console.log('not pass')
                    setCheckanswer4(' is not Correct')
                }
            })
            .catch(() => {
                setCheckanswer4(' is not Correct')
                console.log('not pass')
            })
        }
    }
    const sendAnswer5 = (event) =>{
        event.preventDefault();
        if (answer5 == ""){
            console.log('null data')
        }else{
            const checkanswer = {
                "answer" : answer5,
                "idanswer" : 5
            }
            axios.post('https://serveritlaw.herokuapp.com/question/answer', checkanswer)
                .then((res) => {
                    if(res.status == 200) {
                        setCheckanswer5('Correct')
                        setDatauser5(true)
<<<<<<< Updated upstream

=======
>>>>>>> Stashed changes
                        var token = localStorage.getItem('token')
                        axios.get('https://serveritlaw.herokuapp.com/users/')
                        .then((res)=>{
                            res.data.map((data) => {
                                if(data.iduser == token){
                                    const infomation = {
                                        name : data.name,
                                        imageuser : data.imageuser,
                                        iduser : data.iduser,
                                        email : data.email,
                                        score: 20,
                                        datauser5 : true
                                    }
                                    axios.post('https://serveritlaw.herokuapp.com/renderboard/add', infomation)
                                    .then(() => console.log('pass'))
                                    .catch((er) => console.log(er.message))
                                }else{
                                    console.log('check data1', token)
                                    console.log('check data2', data.iduser)

                                }
                            })
                        })
                    }else{
                        console.log('not pass')
                        setCheckanswer5(' is not Correct')
                    }
                })
                .catch(() => {
                    setCheckanswer5(' is not Correct')
                    console.log('not pass')
                })
        }
    }
    const sendAnswer6 = (event) =>{
        event.preventDefault();
        if (answer6 == ""){
            console.log('null data')
        }else{
        const checkanswer = {
            "answer" : answer6,
            "idanswer" : 6
        }
        axios.post('https://serveritlaw.herokuapp.com/question/answer', checkanswer)
            .then((res) => {
                if(res.status == 200) {
                    setCheckanswer6('Correct')
                    setDatauser6(true)
<<<<<<< Updated upstream


=======
>>>>>>> Stashed changes
                    var token = localStorage.getItem('token')
                    axios.get('https://serveritlaw.herokuapp.com/users/')
                    .then((res)=>{
                        res.data.map((data) => {
                            if(data.iduser == token){
                                const infomation = {
                                    name : data.name,
                                    imageuser : data.imageuser,
                                    iduser : data.iduser,
                                    email : data.email,
                                    score: 20,
                                    datauser6 : true
                                }
                                axios.post('https://serveritlaw.herokuapp.com/renderboard/add', infomation)
                                .then(() => console.log('pass'))
                                .catch((er) => console.log(er.message))
                            }else{
                                console.log('check data1', token)
                                console.log('check data2', data.iduser)

                            }
                        })
                    })
                }else{
                    console.log('not pass')
                    setCheckanswer6(' is not Correct')
                }
            })
            .catch(() => {
                setCheckanswer6(' is not Correct')
                console.log('not pass')
            })
        }
    }
    return(
        <div className="container my-5">
        <div className="card mb-4" style={{marginTop: 150}}>
            <div className="card-header">
            API Hacking
            </div>
            <div className="card-body">
                <h5 className="card-title">เอาเเฟลกมาจาก admin.ให้ได้</h5>
                <p className="card-text">use bearer token</p>
                <Form>
                    <Form.Group controlId="formBasicEmail">
                        <Form.Control type="text" placeholder="Send Answer" value={answer1} onChange={(event) => setAnswer1(event.target.value)}/>
                        {checkanswer1 == "Correct" ? <Form.Label style = {{color : 'green ', fontWeight: 'bold'}}> {checkanswer1} </Form.Label> : <Form.Label style = {{color : 'red ', fontWeight: 'bold'}}> {checkanswer1} </Form.Label> }
                    </Form.Group>
                    <Button variant="primary" type="submit" onClick={sendAnswer1} disabled={datauser1}>
                        Submit
                    </Button>
                </Form>
            </div>
        </div>
        <div className="card mb-4">
            <div className="card-header">
                XSS LocalStorag
            </div>
            <div className="card-body">
                <h5 className="card-title">ersistency is key</h5>
                <p className="card-text"></p>
                <Form>
                    <Form.Group controlId="formBasicEmail">
                    <Form.Control type="text" placeholder="Send Answer" value={answer2} onChange={(event) => setAnswer2(event.target.value)}/>
                        {checkanswer2 == "Correct" ? <Form.Label style = {{color : 'green ', fontWeight: 'bold'}}> {checkanswer2} </Form.Label> : <Form.Label style = {{color : 'red ', fontWeight: 'bold'}}> {checkanswer2} </Form.Label> }                    </Form.Group>
                    <Button variant="primary" type="submit" onClick={sendAnswer2} disabled={datauser2}>
                        Submit
                    </Button>
                </Form>
            </div>
        </div>
        <div className="card mb-4">
            <div className="card-header">
                No-sql Injection
            </div>
            <div className="card-body">
                <h5 className="card-title">No-sql Injectiont</h5>
                {/* <p className="card-text">With supporting text below as a natural lead-in to additional content.</p> */}
                <Form>
                    <Form.Group controlId="formBasicEmail">
                    <Form.Control type="text" placeholder="Send Answer" value={answer3} onChange={(event) => setAnswer3(event.target.value)}/>
                        {checkanswer3 == "Correct" ? <Form.Label style = {{color : 'green ', fontWeight: 'bold'}}> {checkanswer3} </Form.Label> : <Form.Label style = {{color : 'red ', fontWeight: 'bold'}}> {checkanswer3} </Form.Label> }
                    </Form.Group>
                    <Button variant="primary" type="submit" onClick={sendAnswer3} disabled={datauser3}>
                        Submit
                    </Button>
                </Form>
            </div>
        </div>
        <div className="card mb-4">
            <div className="card-header">
            Cookies Attack
            </div>
            <div className="card-body">
                <h5 className="card-title">Cookies Attack</h5>
                {/* <p class="card-text">With supporting text below as a natural lead-in to additional content.</p> */}
                <Form>
                    <Form.Group controlId="formBasicEmail">
                    <Form.Control type="text" placeholder="Send Answer" value={answer4} onChange={(event) => setAnswer4(event.target.value)}/>
                        {checkanswer4 == "Correct" ? <Form.Label style = {{color : 'green ', fontWeight: 'bold'}}> {checkanswer4} </Form.Label> : <Form.Label style = {{color : 'red ', fontWeight: 'bold'}}> {checkanswer4} </Form.Label> }
                    </Form.Group>
                    <Button variant="primary" type="submit" onClick={sendAnswer4} disabled={datauser4}>
                        Submit
                    </Button>
                </Form>
            </div>
        </div>
        <div class="card mb-4">
            <div class="card-header">
                Sql Injection
            </div>
            <div class="card-body">
                <h5 class="card-title">Input is key</h5>
                {/* <p class="card-text">With supporting text below as a natural lead-in to additional content.</p> */}
                <Form>
                    <Form.Group controlId="formBasicEmail">
                    <Form.Control type="text" placeholder="Send Answer" value={answer5} onChange={(event) => setAnswer5(event.target.value)}/>
                        {checkanswer5 == "Correct" ? <Form.Label style = {{color : 'green ', fontWeight: 'bold'}}> {checkanswer5} </Form.Label> : <Form.Label style = {{color : 'red ', fontWeight: 'bold'}}> {checkanswer5} </Form.Label> }
                    </Form.Group>
                    <Button variant="primary" type="submit" onClick={sendAnswer5} disabled={datauser5}>
                        Submit
                    </Button>
                </Form>
            </div>
        </div>
        <div class="card mb-4">
            <div class="card-header">
                Token Is Have Something Wrong?
            </div>
            <div class="card-body">
                <h5 class="card-title">flag is in front of your screen !!!</h5>
                <p class="card-text">use bearer token.</p>
                <Form>
                    <Form.Group controlId="formBasicEmail">
                    <Form.Control type="text" placeholder="Send Answer" value={answer6} onChange={(event) => setAnswer6(event.target.value)}/>
                        {checkanswer6 == "Correct" ? <Form.Label style = {{color : 'green ', fontWeight: 'bold'}}> {checkanswer6} </Form.Label> : <Form.Label style = {{color : 'red ', fontWeight: 'bold'}}> {checkanswer6} </Form.Label> }
                    </Form.Group>
                    <Button variant="primary" type="submit" onClick={sendAnswer6} disabled={datauser6}>
                        Submit
                    </Button>
                </Form>
            </div>
        </div> 
    </div>
    )
}

export default Chalenge