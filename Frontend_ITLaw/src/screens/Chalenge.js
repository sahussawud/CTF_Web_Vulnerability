import React, { useState, useEffect } from "react";
import "../App.css";
import FacebookLogin from "react-facebook-login";
import axios from "axios";
import { Link } from "react-router-dom";
import {
  Navbar,
  Nav,
  NavDropdown,
  Button,
  Form,
  FormControl,
} from "react-bootstrap";

const Chalenge = () => {
  const [count, setCount] = React.useState(0);

  const [datauser1, setDatauser1] = useState(null);
  const [answer1, setAnswer1] = useState("");

  const [datauser2, setDatauser2] = useState(null);
  const [answer2, setAnswer2] = useState("");

  const [datauser3, setDatauser3] = useState(null);
  const [answer3, setAnswer3] = useState("");

  const [datauser4, setDatauser4] = useState(null);
  const [answer4, setAnswer4] = useState("");

  const [datauser5, setDatauser5] = useState(null);
  const [answer5, setAnswer5] = useState("");

  const [datauser6, setDatauser6] = useState(null);
  const [answer6, setAnswer6] = useState("");

  const [checkanswer1, setCheckanswer1] = useState("");
  const [checkanswer2, setCheckanswer2] = useState("");
  const [checkanswer3, setCheckanswer3] = useState("");
  const [checkanswer4, setCheckanswer4] = useState("");
  const [checkanswer5, setCheckanswer5] = useState("");
  const [checkanswer6, setCheckanswer6] = useState("");

  const getDatauser = async () => {
    var token = localStorage.getItem("token");
    console.log("token", token);
    await axios.get("https://serveritlaw.herokuapp.com/users/").then((res) => {
      res.data.map((data) => {
        if (data.iduser == token) {
          setDatauser1(data.question1);
          setDatauser2(data.question2);
          setDatauser3(data.question3);
          setDatauser4(data.question4);
          setDatauser5(data.question5);
          setDatauser6(data.question6);
        }
      });
    });
  };
  useEffect(() => {
    getDatauser();
  }, []);

  const sendAnswer1 = (event) => {
    event.preventDefault();
    if (answer1 == "") {
    } else {
      const checkanswer = {
        answer: answer1,
        idanswer: 1,
      };
      axios
        .post("https://serveritlaw.herokuapp.com/question/answer", checkanswer)
        .then(async (res) => {
          if (res.status == 200) {
            setCheckanswer1("Correct");
            setDatauser1(true);
            var token = localStorage.getItem("token");
            await axios
              .get("https://serveritlaw.herokuapp.com/users/")
              .then((res) => {
                res.data.map(async (data) => {
                  if (data.iduser == token) {
                    const infomation = {
                      name: data.name,
                      imageuser: data.imageuser,
                      iduser: data.iduser,
                      email: data.email,
                      score: 20,
                      datauser1: true,
                    };
                    await axios
                      .post(
                        "https://serveritlaw.herokuapp.com/renderboard/add",
                        infomation
                      )
                      .then(async () => {})
                      .catch((er) => console.log(er.message));
                  } else {
                    console.log("check data1", token);
                    console.log("check data2", data.iduser);
                  }
                });
              });
          } else {
            console.log("not pass");
            setCheckanswer1(" is not Correct");
          }
        })
        .catch(() => {
          setCheckanswer1(" is not Correct");
          console.log("not pass");
        });
    }
  };

  const sendAnswer2 = (event) => {
    event.preventDefault();
    if (answer2 == "") {
    } else {
      const checkanswer = {
        answer: answer2,
        idanswer: 2,
      };
      axios
        .post("https://serveritlaw.herokuapp.com/question/answer", checkanswer)
        .then((res) => {
          if (res.status == 200) {
            setCheckanswer2("Correct");
            setDatauser2(true);
            var token = localStorage.getItem("token");
            axios
              .get("https://serveritlaw.herokuapp.com/users/")
              .then((res) => {
                res.data.map((data) => {
                  if (data.iduser == token) {
                    const infomation = {
                      name: data.name,
                      imageuser: data.imageuser,
                      iduser: data.iduser,
                      email: data.email,
                      score: 20,
                      datauser2: true,
                    };
                    axios
                      .post(
                        "https://serveritlaw.herokuapp.com/renderboard/add",
                        infomation
                      )
                      .then(() => window.location.reload())
                      .catch((er) => console.log(er.message));
                  } else {
                    console.log("check data1", token);
                    console.log("check data2", data.iduser);
                  }
                });
              });
          } else {
            console.log("not pass");
            setCheckanswer2(" is not Correct");
          }
        })
        .catch(() => {
          setCheckanswer2(" is not Correct");
          console.log("not pass");
        });
    }
  };
  const sendAnswer3 = (event) => {
    event.preventDefault();
    if (answer3 == "") {
      console.log("null data");
    } else {
      const checkanswer = {
        answer: answer3,
        idanswer: 3,
      };
      axios
        .post("https://serveritlaw.herokuapp.com/question/answer", checkanswer)
        .then((res) => {
          if (res.status == 200) {
            setCheckanswer3("Correct");
            setDatauser3(true);
            var token = localStorage.getItem("token");
            axios
              .get("https://serveritlaw.herokuapp.com/users/")
              .then((res) => {
                res.data.map((data) => {
                  if (data.iduser == token) {
                    const infomation = {
                      name: data.name,
                      imageuser: data.imageuser,
                      iduser: data.iduser,
                      email: data.email,
                      score: 20,
                      datauser3: true,
                    };
                    axios
                      .post(
                        "https://serveritlaw.herokuapp.com/renderboard/add",
                        infomation
                      )
                      .then(() => console.log("pass"))
                      .catch((er) => console.log(er.message));
                  } else {
                    console.log("check data1", token);
                    console.log("check data2", data.iduser);
                  }
                });
              });
          } else {
            console.log("not pass");
            setCheckanswer3(" is not Correct");
          }
        })
        .catch(() => {
          setCheckanswer3(" is not Correct");
          console.log("not pass");
        });
    }
  };
  const sendAnswer4 = (event) => {
    event.preventDefault();
    if (answer4 == "") {
      console.log("nuul data");
    } else {
      const checkanswer = {
        answer: answer4,
        idanswer: 4,
      };
      axios
        .post("https://serveritlaw.herokuapp.com/question/answer", checkanswer)
        .then((res) => {
          if (res.status == 200) {
            setCheckanswer4("Correct");
            setDatauser4(true);
            var token = localStorage.getItem("token");
            axios
              .get("https://serveritlaw.herokuapp.com/users/")
              .then((res) => {
                res.data.map((data) => {
                  if (data.iduser == token) {
                    const infomation = {
                      name: data.name,
                      imageuser: data.imageuser,
                      iduser: data.iduser,
                      email: data.email,
                      score: 20,
                      datauser4: true,
                    };
                    axios
                      .post(
                        "https://serveritlaw.herokuapp.com/renderboard/add",
                        infomation
                      )
                      .then(() => console.log("pass"))
                      .catch((er) => console.log(er.message));
                  } else {
                    console.log("check data1", token);
                    console.log("check data2", data.iduser);
                  }
                });
              });
          } else {
            console.log("not pass");
            setCheckanswer4(" is not Correct");
          }
        })
        .catch(() => {
          setCheckanswer4(" is not Correct");
          console.log("not pass");
        });
    }
  };
  const sendAnswer5 = (event) => {
    event.preventDefault();
    if (answer5 == "") {
      console.log("null data");
    } else {
      const checkanswer = {
        answer: answer5,
        idanswer: 5,
      };
      axios
        .post("https://serveritlaw.herokuapp.com/question/answer", checkanswer)
        .then((res) => {
          if (res.status == 200) {
            setCheckanswer5("Correct");
            setDatauser5(true);
            var token = localStorage.getItem("token");
            axios
              .get("https://serveritlaw.herokuapp.com/users/")
              .then((res) => {
                res.data.map((data) => {
                  if (data.iduser == token) {
                    const infomation = {
                      name: data.name,
                      imageuser: data.imageuser,
                      iduser: data.iduser,
                      email: data.email,
                      score: 20,
                      datauser5: true,
                    };
                    axios
                      .post(
                        "https://serveritlaw.herokuapp.com/renderboard/add",
                        infomation
                      )
                      .then(() => console.log("pass"))
                      .catch((er) => console.log(er.message));
                  } else {
                    console.log("check data1", token);
                    console.log("check data2", data.iduser);
                  }
                });
              });
          } else {
            console.log("not pass");
            setCheckanswer5(" is not Correct");
          }
        })
        .catch(() => {
          setCheckanswer5(" is not Correct");
          console.log("not pass");
        });
    }
  };
  const sendAnswer6 = (event) => {
    event.preventDefault();
    if (answer6 == "") {
      console.log("null data");
    } else {
      const checkanswer = {
        answer: answer6,
        idanswer: 6,
      };
      axios
        .post("https://serveritlaw.herokuapp.com/question/answer", checkanswer)
        .then((res) => {
          if (res.status == 200) {
            setCheckanswer6("Correct");
            setDatauser6(true);

            var token = localStorage.getItem("token");
            axios
              .get("https://serveritlaw.herokuapp.com/users/")
              .then((res) => {
                res.data.map((data) => {
                  if (data.iduser == token) {
                    const infomation = {
                      name: data.name,
                      imageuser: data.imageuser,
                      iduser: data.iduser,
                      email: data.email,
                      score: 20,
                      datauser6: true,
                    };
                    axios
                      .post(
                        "https://serveritlaw.herokuapp.com/renderboard/add",
                        infomation
                      )
                      .then(() => console.log("pass"))
                      .catch((er) => console.log(er.message));
                  } else {
                    console.log("check data1", token);
                    console.log("check data2", data.iduser);
                  }
                });
              });
          } else {
            console.log("not pass");
            setCheckanswer6(" is not Correct");
          }
        })
        .catch(() => {
          setCheckanswer6(" is not Correct");
          console.log("not pass");
        });
    }
  };

  const question = [
    <div>
      <h3 className="font-mitr">API Hacking</h3>
      <hr />
      <div className="text-center m-5">
        <img
          className="img-fluid"
          src="https://i.ytimg.com/vi/Fa1zlLEGPtw/maxresdefault.jpg"
          style={{ width: "70%", height: "35%", borderRadius: 10 }}
        />
      </div>
      <div>
        <h5 className="font-mitr d-inline" style={{ lineHeight: 2.5 }}>
          <h3 className="font-mitr text-info d-inline pr-3">D.</h3>
          Lorem Ipsum is simply dummy text of the printing and typesetting
          industry. Lorem Ipsum has been the industry's standard dummy text ever
          since the 1500s, when an unknown printer took a galley of type and
          scrambled it to make a type specimen book. It has survived not only
          five centuries, but also the leap into electronic typesetting,
          remaining essentially unchanged. It was popularised in the 1960s with
          the release of Letraset sheets containing Lorem Ipsum passages, and
          more recently with desktop publishing software like Aldus PageMaker
          including versions of Lorem Ipsum.
        </h5>
        <h5 className="font-mitr">
          <h3 className="font-mitr text-success d-inline pr-3">Q.</h3>
          เอา Flag มาจาก Admin ให้ได้
        </h5>
        <h5 className="font-mitr my-3">
          <h3 className="font-mitr text-danger d-inline pr-3">H.</h3>Use Bearer
          Token
        </h5>
        <Form>
          <Form.Group>
            <Form.Control
              className="p-3 mt-4 font-k2d"
              type="text"
              placeholder="Send Answer"
              value={answer1}
              onChange={(event) => setAnswer1(event.target.value)}
            />
            {checkanswer1 == "Correct" ? (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "green ", fontWeight: "bold" }}
              >
                {checkanswer1}
              </Form.Label>
            ) : (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "red ", fontWeight: "bold" }}
              >
                {checkanswer1}
              </Form.Label>
            )}
          </Form.Group>
          <Button
            className="btn-lg btn-block btn btn-outline-success"
            variant="primary"
            type="submit"
            onClick={sendAnswer1}
            disabled={datauser1}
          >
            Submit
          </Button>
        </Form>
      </div>
    </div>,
    <div>
      <h3 className="font-mitr">XSS LocalStorage</h3>
      <hr />
      <div className="text-center m-5">
        <img
          className="img-fluid"
          src="https://i.ytimg.com/vi/M6N7gEZ-IUQ/maxresdefault.jpg"
          style={{ width: "70%", height: "35%", borderRadius: 10 }}
        />
      </div>
      <div>
        <h5 className="font-mitr" style={{ lineHeight: 2.5 }}>
          <h3 className="font-mitr text-info d-inline pr-3">D.</h3>
          Lorem Ipsum is simply dummy text of the printing and typesetting
          industry. Lorem Ipsum has been the industry's standard dummy text ever
          since the 1500s, when an unknown printer took a galley of type and
          scrambled it to make a type specimen book. It has survived not only
          five centuries, but also the leap into electronic typesetting,
          remaining essentially unchanged. It was popularised in the 1960s with
          the release of Letraset sheets containing Lorem Ipsum passages, and
          more recently with desktop publishing software like Aldus PageMaker
          including versions of Lorem Ipsum.
        </h5>
        <h5 className="font-mitr d-inline">
          <h3 className="font-mitr text-danger d-inline pr-3">Q.</h3>
          ersistency is key
        </h5>
        <Form>
          <Form.Group>
            <Form.Control
              className="p-3 mt-4 font-k2d"
              type="text"
              placeholder="Send Answer"
              value={answer2}
              onChange={(event) => setAnswer2(event.target.value)}
            />
            {checkanswer2 == "Correct" ? (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "green ", fontWeight: "bold" }}
              >
                {" "}
                {checkanswer2}{" "}
              </Form.Label>
            ) : (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "red ", fontWeight: "bold" }}
              >
                {" "}
                {checkanswer2}{" "}
              </Form.Label>
            )}{" "}
          </Form.Group>
          <Button
            className="btn-lg btn-block btn btn-outline-success"
            variant="primary"
            type="submit"
            onClick={sendAnswer2}
            disabled={datauser2}
          >
            Submit
          </Button>
        </Form>
      </div>
    </div>,
    <div>
      <h3 className="font-mitr">No-sql Injection</h3>
      <hr />
      <div className="text-center m-5">
        <img
          className="img-fluid"
          src="https://dpsvdv74uwwos.cloudfront.net/statics/img/blogposts/no-sql-injection.png"
          style={{ width: "70%", height: "35%", borderRadius: 10 }}
        />
      </div>
      <div>
        <h5 className="font-mitr" style={{ lineHeight: 2.5 }}>
          <h3 className="font-mitr text-info d-inline pr-3">D.</h3>
          Lorem Ipsum is simply dummy text of the printing and typesetting
          industry. Lorem Ipsum has been the industry's standard dummy text ever
          since the 1500s, when an unknown printer took a galley of type and
          scrambled it to make a type specimen book. It has survived not only
          five centuries, but also the leap into electronic typesetting,
          remaining essentially unchanged. It was popularised in the 1960s with
          the release of Letraset sheets containing Lorem Ipsum passages, and
          more recently with desktop publishing software like Aldus PageMaker
          including versions of Lorem Ipsum.
        </h5>
        <h5 className="font-mitr d-inline">
          <h3 className="font-mitr text-danger d-inline pr-3">Q.</h3>
          No-sql Injectiont
        </h5>
        <Form>
          <Form.Group>
            <Form.Control
              className="p-3 mt-4 font-k2d"
              type="text"
              placeholder="Send Answer"
              value={answer3}
              onChange={(event) => setAnswer3(event.target.value)}
            />
            {checkanswer3 == "Correct" ? (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "green ", fontWeight: "bold" }}
              >
                {" "}
                {checkanswer3}{" "}
              </Form.Label>
            ) : (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "red ", fontWeight: "bold" }}
              >
                {" "}
                {checkanswer3}{" "}
              </Form.Label>
            )}
          </Form.Group>
          <Button
            className="btn-lg btn-block btn btn-outline-success"
            variant="primary"
            type="submit"
            onClick={sendAnswer3}
            disabled={datauser3}
          >
            Submit
          </Button>
        </Form>
      </div>
    </div>,
    <div>
      <h3 className="font-mitr">Cookies Attack</h3>
      <hr />
      <div className="text-center m-5">
        <img
          className="img-fluid"
          src="https://i.pinimg.com/originals/2b/99/10/2b9910aa6732cd292bc9127195b96671.jpg"
          style={{ width: "70%", height: "35%", borderRadius: 10 }}
        />
      </div>
      <div>
        <h5 className="font-mitr" style={{ lineHeight: 2.5 }}>
          <h3 className="font-mitr text-info d-inline pr-3">D.</h3>
          Lorem Ipsum is simply dummy text of the printing and typesetting
          industry. Lorem Ipsum has been the industry's standard dummy text ever
          since the 1500s, when an unknown printer took a galley of type and
          scrambled it to make a type specimen book. It has survived not only
          five centuries, but also the leap into electronic typesetting,
          remaining essentially unchanged. It was popularised in the 1960s with
          the release of Letraset sheets containing Lorem Ipsum passages, and
          more recently with desktop publishing software like Aldus PageMaker
          including versions of Lorem Ipsum.
        </h5>
        <h5 className="font-mitr d-inline">
          <h3 className="font-mitr text-danger d-inline pr-3">Q.</h3>
          Cookies Attack
        </h5>
        <Form>
          <Form.Group>
            <Form.Control
              className="p-3 mt-4 font-k2d"
              type="text"
              placeholder="Send Answer"
              value={answer4}
              onChange={(event) => setAnswer4(event.target.value)}
            />
            {checkanswer4 == "Correct" ? (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "green ", fontWeight: "bold" }}
              >
                {" "}
                {checkanswer4}{" "}
              </Form.Label>
            ) : (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "red ", fontWeight: "bold" }}
              >
                {" "}
                {checkanswer4}{" "}
              </Form.Label>
            )}
          </Form.Group>
          <Button
            className="btn-lg btn-block btn btn-outline-success"
            variant="primary"
            type="submit"
            onClick={sendAnswer4}
            disabled={datauser4}
          >
            Submit
          </Button>
        </Form>
      </div>
    </div>,
    <div>
      <h3 className="font-mitr">Sql Injection</h3>
      <hr />
      <div className="text-center m-5">
        <img
          className="img-fluid"
          src="https://pronto-core-cdn.prontomarketing.com/2/wp-content/uploads/sites/1123/2017/07/1473921124injection-attack.jpg"
          style={{ width: "70%", height: "35%", borderRadius: 10 }}
        />
      </div>
      <div>
        <h5 className="font-mitr" style={{ lineHeight: 2.5 }}>
          <h3 className="font-mitr text-info d-inline pr-3">D.</h3>
          Lorem Ipsum is simply dummy text of the printing and typesetting
          industry. Lorem Ipsum has been the industry's standard dummy text ever
          since the 1500s, when an unknown printer took a galley of type and
          scrambled it to make a type specimen book. It has survived not only
          five centuries, but also the leap into electronic typesetting,
          remaining essentially unchanged. It was popularised in the 1960s with
          the release of Letraset sheets containing Lorem Ipsum passages, and
          more recently with desktop publishing software like Aldus PageMaker
          including versions of Lorem Ipsum.
        </h5>
        <h5 className="font-mitr d-inline">
          <h3 className="font-mitr text-danger d-inline pr-3">Q.</h3>
          Input is key
        </h5>
        <Form>
          <Form.Group>
            <Form.Control
              className="p-3 mt-4 font-k2d"
              type="text"
              placeholder="Send Answer"
              value={answer5}
              onChange={(event) => setAnswer5(event.target.value)}
            />
            {checkanswer5 == "Correct" ? (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "green ", fontWeight: "bold" }}
              >
                {" "}
                {checkanswer5}{" "}
              </Form.Label>
            ) : (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "red ", fontWeight: "bold" }}
              >
                {" "}
                {checkanswer5}{" "}
              </Form.Label>
            )}
          </Form.Group>
          <Button
            className="btn-lg btn-block btn btn-outline-success"
            variant="primary"
            type="submit"
            onClick={sendAnswer5}
            disabled={datauser5}
          >
            Submit
          </Button>
        </Form>
      </div>
    </div>,
    <div>
      <h3 className="font-mitr">Token Is Have Something Wrong?</h3>
      <hr />
      <div className="text-center m-5">
        <img
          className="img-fluid"
          src="https://storage.googleapis.com/techsauce-prod/uploads/2019/04/Cyber-security.jpg"
          style={{ width: "70%", height: "35%", borderRadius: 10 }}
        />
      </div>
      <div>
        <h5 className="font-mitr" style={{ lineHeight: 2.5 }}>
          <h3 className="font-mitr text-info d-inline pr-3">D.</h3>
          Lorem Ipsum is simply dummy text of the printing and typesetting
          industry. Lorem Ipsum has been the industry's standard dummy text ever
          since the 1500s, when an unknown printer took a galley of type and
          scrambled it to make a type specimen book. It has survived not only
          five centuries, but also the leap into electronic typesetting,
          remaining essentially unchanged. It was popularised in the 1960s with
          the release of Letraset sheets containing Lorem Ipsum passages, and
          more recently with desktop publishing software like Aldus PageMaker
          including versions of Lorem Ipsum.
        </h5>
        <h5 className="font-mitr d-inline">
          <h3 className="font-mitr text-danger d-inline pr-3">Q.</h3>
          flag is in front of your screen !!!
        </h5>
        <h5 className="font-mitr my-3">
          <h3 className="font-mitr text-danger d-inline pr-3">H.</h3>use bearer
          token
        </h5>
        <Form>
          <Form.Group>
            <Form.Control
              className="p-3 mt-4 font-k2d"
              type="text"
              placeholder="Send Answer"
              value={answer6}
              onChange={(event) => setAnswer6(event.target.value)}
            />
            {checkanswer6 == "Correct" ? (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "green ", fontWeight: "bold" }}
              >
                {" "}
                {checkanswer6}{" "}
              </Form.Label>
            ) : (
              <Form.Label
                className="font-k2d h5 mt-2"
                style={{ color: "red ", fontWeight: "bold" }}
              >
                {" "}
                {checkanswer6}{" "}
              </Form.Label>
            )}
          </Form.Group>
          <Button
            className="btn-lg btn-block btn btn-outline-success"
            variant="primary"
            type="submit"
            onClick={sendAnswer6}
            disabled={datauser6}
          >
            Submit
          </Button>
        </Form>
      </div>
    </div>,
  ];

  return (
    <div>
      <img src="https://images.pexels.com/photos/193349/pexels-photo-193349.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940" id="bg"/>
      <div className="container">
        <div className="card cardtable p-5" style={{marginTop: 150, marginBottom: 80}}>
          <div className="card-body">
            {question[count]}
            <hr />
            <div className="d-flex justify-content-between">
              {count > 0 && (
                <button
                  class="btn btn-secondary p-3 font-mitr"
                  onClick={() => setCount(count - 1)}
                >
                  prev
                </button>
              )}
              {count < question.length - 1 && (
                <button
                  class="btn btn-warning p-3 font-mitr"
                  onClick={() => setCount(count + 1)}
                >
                  next
                </button>
              )}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default Chalenge;
