# CTF_Web_Vulnerability
Question on CTF !!!

### ชื่อโจทย์ : API Hacking <พร้อมทดสอบ>
ความยาก(10) : 3  
Description : use bearer token  
Hint : เอาเเฟลกมาจาก admin.ให้ได้  
Format answer : CTF{}  

สิ่งที่ต้องทำ :  
- Page Web api docs /index  
- Path /auth เพือ authen ใส่ชื่อเพื่อ  
- Path /user   
- Path /admin  

ควานรู้ที่ต้องใช้  
- JWT token  

###### Key เฉลย:  

1. discover a document page that inform  3 api api/admin, api/user, api/auth
2. gain authentication JWT token from api/auth pass query parameter username to gain bearer token
3. try to use bearer token, it works to access user endpoint, but not with admin endpoint.
4. Try decode JWT token with www.jwt.io, then you will see payload data, name as username and role as User.
5. Try to change role in JWT.io, I will occur 401 Unauthorize, because a JWT Token is invalid signature key to make change to a token.
6. You try to temple token by jwtcat(recommmend) or jwtcrack, I use jwtcat to find a secret it would occur pungpondzard
7. You could use secret to temper token, and putting it into autorization header as bearer token, and now you could get a FLAgz OLA. 

> answer : Q_api{JwT_ExploiTi0n_Is_C0ol}

### ชื่อโจทย์ : Token Is Have Something Wrong? <พร้อมทดลอบ>  
ความยาก(10) : 6  
Description : there is someting wrong with token, look it carefully.   
Hint : flag is in front of your screen !!!  
answer format : Q_token{}  

สิ่งที่ต้องทำ :    
- เว็บไซต์ที่มีการส่ง ajax request เเล้วถูกอีก domain หนึ่งนั้นไป execute request เรา่โดยที่เราไม่รู้ตัว วิธีการนี้เรียกว่า CSRF Attack 

ควานรู้ที่ต้องใช้:  
- ajax  
- csrf token  

###### Key: 
1. เว็บไซต์เเสดงหน้าตาฟอร์ม Reset password เเต่ไม่เกี่ยวกับการเเก้โจทย์ข้อนี้
2. key is on ajax request to index.php that occur message in response that "try to send post request by another host, this is concept behind CSRF" ดูที่ network tab ที่ browser ปรากฎคำใบ้ให้ลองส่งฟอร์มเเละ token ให้ไปลอง request ไปที่ index.php โดยใช้ client อื่นที่ไม่ใช่ ตัวเว็บไซต์
3. จากนั้น "Failed Comparison ( incoming CSRF token != Session CSRF token )" ปรากฎ เเละมีการใบ้ต่อว่า มีช่องโหว่ที่ weak comparison
4. break to if checking bypass "_token": true instread, now flag is appearing.  

> answer Q_token{ThlsC5RFi5Sup3REzy}  


###### ชื่อโจทย์ : No-sql Injection && Cookies Attack
ความยาก(10) : 4
Description :  
Hint : คำใบ้บอกไปเเล้ว
สิ่งที่ต้องทำ : 
มี input username, password ทำการบายพาส เข้าเพื่อเอา flags
ควานรู้ที่ต้องใช้ 
NoSql statement 


###### ชื่อโจทย์ : XSS rolling 
ความยาก(10) : 
Description :  Cookies Attack
Hint : คำใบ้บอกไปเเล้ว
ANSWER : C{M9GiC4l}
สิ่งที่ต้องทำ : 
 ต้องนำ flag ที่ซ้อนอยู่ในรูปภาพ มาตอบ
ควานรู้ที่ต้องใช้ 
- CSS 
- JAVASCRIPTS

###### Key: 
1. เป็นหน้า search engine ที่มี bug ที่ช่อง input ที่สามารถคำการเรียนรู้การ inject ให้เว็บไซต์ รัน javascript ได้ สามารถใช้จุดนี้ในการขโมยข้อมูลสำคัญกลับมาผู้ที่ เเทรก scripts ได้
2. behind CSRF" ดูที่ network tab ที่ browser ปรากฎคำใบ้ให้ลองส่งฟอร์มเเละ token ให้ไปลอง request ไปที่ index.php โดยใช้ client อื่นที่ไม่ใช่ ตัวเว็บไซต์ 
3. ตั้งใจจะ ใช้ <script></script> execute ให้คำใบ้ถัดไปที่จะบอกเกี่ยวกับคำใบ้ที่มีอยู่ 
4. คำตอบซ้อนอยู่ในภาพที่อยู่บน ภาพเเต่ต้องใช้ การหมุน อาจจะทำอะไรบ้างอย่าง ให้ภาพหมุน ด้วยความเร็ว flag จะปรากฎ  



